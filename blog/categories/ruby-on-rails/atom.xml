<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: ruby-on-rails | My Octopress Blog]]></title>
  <link href="http://davwood.github.io/blog/categories/ruby-on-rails/atom.xml" rel="self"/>
  <link href="http://davwood.github.io/"/>
  <updated>2014-04-01T16:19:32+11:00</updated>
  <id>http://davwood.github.io/</id>
  <author>
    <name><![CDATA[Your Name]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Setting up Spree to play with Amazon S3]]></title>
    <link href="http://davwood.github.io/blog/2014/03/22/setting-up-spree-to-play-wth-amazon-s3/"/>
    <updated>2014-03-22T10:23:01+11:00</updated>
    <id>http://davwood.github.io/blog/2014/03/22/setting-up-spree-to-play-wth-amazon-s3</id>
    <content type="html"><![CDATA[<p>S3 is needed to host images when using heroku or other similar services (like ninefold). This is because heroku’s filesystem is readonly, so when uploading images (except with deploy) we need to use an off-site sever such as S3.</p>

<p>Spree used to have S3 configurable as part of the admin back end.
However, Spree in 2-2-stable has now dropped this integration.
<a href="https://github.com/spree/spree/commit/b1d6c5e4b9801d888cc76c05116b814945122207">https://github.com/spree/spree/commit/b1d6c5e4b9801d888cc76c05116b814945122207</a>
We must refer to the paperclip documentation instead.
<a href="https://github.com/thoughtbot/paperclip">https://github.com/thoughtbot/paperclip</a></p>

<p>But spree has some config options available within initializers/spree.rb
see below:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Spree</span><span class="o">.</span><span class="n">config</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;   # Example:</span>
</span><span class='line'><span class="sr">   # Uncomment to override the default site name.</span>
</span><span class='line'><span class="sr">   config.site_name = &quot;Gazella Running Costumes&quot;</span>
</span><span class='line'><span class="sr">   config.logo = &quot;store/</span><span class="n">rungazella</span><span class="o">.</span><span class="n">png</span><span class="s2">&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">  #S3 configuration</span>
</span><span class='line'><span class="s2">  if Rails.env.production? then</span>
</span><span class='line'><span class="s2">       #production. Store images on S3.</span>
</span><span class='line'><span class="s2">       # development will default to local storage</span>
</span><span class='line'><span class="s2">      attachment_config = {</span>
</span><span class='line'><span class="s2">      s3_credentials: {</span>
</span><span class='line'><span class="s2">        access_key_id: ENV[&quot;</span><span class="no">S3_KEY</span><span class="s2">&quot;],</span>
</span><span class='line'><span class="s2">        secret_access_key: ENV[&quot;</span><span class="no">S3_SECRET</span><span class="s2">&quot;],</span>
</span><span class='line'><span class="s2">        bucket: ENV[&quot;</span><span class="no">S3_BUCKET</span><span class="s2">&quot;],</span>
</span><span class='line'><span class="s2">      },</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="s2">      storage:        :s3,</span>
</span><span class='line'><span class="s2">      s3_headers:     { &quot;</span><span class="no">Cache</span><span class="o">-</span><span class="no">Control</span><span class="s2">&quot; =&amp;gt; &quot;</span><span class="n">max</span><span class="o">-</span><span class="n">age</span><span class="o">=</span><span class="mi">31557600</span><span class="s2">&quot; },</span>
</span><span class='line'><span class="s2">      s3_protocol:    &quot;</span><span class="n">https</span><span class="s2">&quot;,</span>
</span><span class='line'><span class="s2">      bucket:         ENV[&quot;</span><span class="no">S3_BUCKET</span><span class="s2">&quot;],</span>
</span><span class='line'>
</span><span class='line'><span class="s2">      path:          &quot;</span><span class="ss">:rails_root</span><span class="o">/</span><span class="kp">public</span><span class="o">/</span><span class="ss">:class</span><span class="o">/</span><span class="ss">:attachment</span><span class="o">/</span><span class="ss">:id</span><span class="o">/</span><span class="ss">:style</span><span class="o">/</span><span class="ss">:basename</span><span class="o">.</span><span class="ss">:extension</span><span class="s2">&quot;,</span>
</span><span class='line'><span class="s2">      default_url:   &quot;</span><span class="o">/</span><span class="ss">:class</span><span class="o">/</span><span class="ss">:attachment</span><span class="o">/</span><span class="ss">:id</span><span class="o">/</span><span class="ss">:style</span><span class="o">/</span><span class="ss">:basename</span><span class="o">.</span><span class="ss">:extension</span><span class="s2">&quot;,</span>
</span><span class='line'><span class="s2">      default_style: &quot;</span><span class="n">product</span><span class="s2">&quot;,</span>
</span><span class='line'><span class="s2">      }</span>
</span><span class='line'>
</span><span class='line'><span class="s2">      attachment_config.each do |key, value|</span>
</span><span class='line'><span class="s2">           Spree::Image.attachment_definitions[:attachment][key.to_sym] = value</span>
</span><span class='line'><span class="s2">      end</span>
</span><span class='line'><span class="s2"> end</span>
</span><span class='line'><span class="s2">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;end</span>
</span><span class='line'><span class="s2">Spree.user_class = &amp;ldquo;Spree::User&amp;rdquo;</span>
</span><span class='line'><span class="s2">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>note: the environmental variables were then added to heroku using
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>heroku config:set S3_KEY=your_access_key
</span><span class='line'>heroku config:set S3_SECRET=your_secret_key
</span><span class='line'>heroku config:set S3_BUCKET=your_bucket_name</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h3>Additional Notes:</h3>

<p>Update to the paperclip defaults for image sizes
<a href="http://guides.spreecommerce.com/developer/logic.html">http://guides.spreecommerce.com/developer/logic.html</a></p>

<p>To change the paperclip defaults for image sizes I created the file app/models/spree/image_decorator.rb. And added this:
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">Spree</span><span class="p">:</span><span class="ss">:Image</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">attachment_definitions</span><span class="o">[</span><span class="ss">:attachment</span><span class="o">][</span><span class="ss">:styles</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;mini:     &quot;50x60&amp;gt;&quot;, #used for the thumbnails</span>
</span><span class='line'><span class="sr">small:    &quot;120x144&amp;gt;&quot;, #used for the product listing</span>
</span><span class='line'><span class="sr">product:  &quot;300x361&amp;gt;&quot;, #used for the main product page</span>
</span><span class='line'><span class="sr">large:    &quot;700x841&amp;gt;&quot; #could be used for hovering</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  }</span>
</span><span class='line'><span class="sr">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Uploading Images with Ckeditor</h2>

<p>I had naively thought that updating the above would allow also work for the blog I had added to my site using the <a href="https://github.com/stefansenk/spree-blogging-spree">spree-blogging-spree</a> gem. Unfortunately ckeditor didn&rsquo;t recognise spree straight away but it can be configured with paperclip.</p>

<p>Based on this I could update app/models/ckeditor/picture.rb to:</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Ckeditor</span><span class="o">::</span><span class="no">Picture</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="ss">Ckeditor</span><span class="p">:</span><span class="ss">:Asset</span>
</span><span class='line'>  <span class="n">has_attached_file</span> <span class="ss">:data</span><span class="p">,</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;                styles: { :content =&amp;gt; &#39;600&amp;gt;&#39;, :thumb =&amp;gt; &#39;118x100#&#39; },</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;   s3_credentials: {&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>      <span class="n">access_key_id</span><span class="p">:</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_KEY&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>      <span class="n">secret_access_key</span><span class="p">:</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_SECRET&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>      <span class="ss">bucket</span><span class="p">:</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_BUCKET&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'><span class="ss">storage</span><span class="p">:</span> <span class="ss">:s3</span><span class="p">,</span>
</span><span class='line'><span class="n">s3_headers</span><span class="p">:</span>     <span class="p">{</span> <span class="s2">&quot;Cache-Control&quot;</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="s2">&quot;max-age=31557600&quot;</span> <span class="p">},</span>
</span><span class='line'><span class="n">s3_protocol</span><span class="p">:</span>    <span class="s2">&quot;https&quot;</span><span class="p">,</span>
</span><span class='line'><span class="ss">bucket</span><span class="p">:</span>         <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_BUCKET&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'><span class="ss">path</span><span class="p">:</span> <span class="s2">&quot;/:class/:attachment/:id/:style/:basename.:extension&quot;</span><span class="p">,</span>
</span><span class='line'><span class="n">default_url</span><span class="p">:</span>   <span class="s2">&quot;/:class/:attachment/:id/:style/:basename.:extension&quot;</span><span class="p">,</span>
</span><span class='line'><span class="n">default_style</span><span class="p">:</span> <span class="s2">&quot;medium&quot;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="n">validates_attachment_size</span> <span class="ss">:data</span><span class="p">,</span> <span class="ss">:less_than</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="o">.</span><span class="n">megabytes</span>
</span><span class='line'>  <span class="n">validates_attachment_presence</span> <span class="ss">:data</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  def url_content&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">url</span><span class="p">(</span><span class="ss">:content</span><span class="p">)</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Getting a Spree Site onto Heroku]]></title>
    <link href="http://davwood.github.io/blog/2014/03/10/getting-a-spree-site-onto-heroku/"/>
    <updated>2014-03-10T09:29:44+11:00</updated>
    <id>http://davwood.github.io/blog/2014/03/10/getting-a-spree-site-onto-heroku</id>
    <content type="html"><![CDATA[<p>I had a great Spree E-commerce working fine on the localhost &ndash; and then I needed to get it onto heroku. Easy right? As someone who has used heroku a few times before (but not for a little while) I remembered it was pretty much a simple case of &lsquo;git push heroku master&rsquo;. Nope!!</p>

<p>Below is some coverage of what I needed to do. Hopefully it can be of use.</p>

<p>This was using spree branch &lsquo;2-2-stable&rsquo; with a postgresql database.</p>

<h2>Step 1: Update the web server to unicorn</h2>

<p>Add the gem &lsquo;unicorn&rsquo; and create a file &lsquo;config/unicorn.rb&rsquo;. The put the below into the file:</p>

<pre><code><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">worker_processes</span> <span class="nb">Integer</span><span class="p">(</span><span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;WEB_CONCURRENCY&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="mi">3</span><span class="p">)</span>
</span><span class='line'><span class="n">timeout</span>
</span><span class='line'><span class="n">timeout</span> <span class="mi">15</span>
</span><span class='line'><span class="n">preload_app</span> <span class="kp">true</span>
</span><span class='line'><span class="n">before_fork</span> <span class="k">do</span> <span class="o">|</span><span class="n">server</span><span class="p">,</span> <span class="n">worker</span><span class="o">|</span>
</span><span class='line'>  <span class="no">Signal</span><span class="o">.</span><span class="n">trap</span> <span class="s1">&#39;TERM&#39;</span> <span class="k">do</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s1">&#39;Unicorn master intercepting TERM and sending myself QUIT instead&#39;</span>
</span><span class='line'>    <span class="no">Process</span><span class="o">.</span><span class="n">kill</span> <span class="s1">&#39;QUIT&#39;</span><span class="p">,</span> <span class="no">Process</span><span class="o">.</span><span class="n">pid</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">defined?</span><span class="p">(</span><span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="p">)</span> <span class="ow">and</span>
</span><span class='line'>    <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">disconnect!</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="n">after_fork</span> <span class="k">do</span> <span class="o">|</span><span class="n">server</span><span class="p">,</span> <span class="n">worker</span><span class="o">|</span>
</span><span class='line'>  <span class="no">Signal</span><span class="o">.</span><span class="n">trap</span> <span class="s1">&#39;TERM&#39;</span> <span class="k">do</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s1">&#39;Unicorn worker intercepting TERM and doing nothing. Wait for master to send QUIT&#39;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">defined?</span><span class="p">(</span><span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="p">)</span> <span class="ow">and</span>
</span><span class='line'>    <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">establish_connection</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>
</code></pre>

<ul>
<li>create a Procfile in the root directory</li>
<li>in the Procfile write:
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>web: bundle exec unicorn -p $PORT -c ./config/unicorn.rb</span></code></pre></td></tr></table></div></figure></notextile></div></li>
<li>create a .env file to hold environment variables and add it to .gitignore!</li>
</ul>


<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>echo &ldquo;RACK_ENV=development&rdquo; >>.env
</span><span class='line'>echo &ldquo;PORT=3000&rdquo; >> .env
</span><span class='line'>echo &ldquo;.env&rdquo; >> .gitignore
</span><span class='line'>git add .gitignore
</span><span class='line'>git commit -m &ldquo;add .env to .gitignore&rdquo;</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<ul>
<li>gem install foreman</li>
<li>foreman start</li>
</ul>


<p>Now running unicorn! :)</p>

<h2>Step 2: Rails App Config Updates</h2>

<ul>
<li><p>Remove username from database.yml
Production looks like:
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>production:
</span><span class='line'>  adapter: postgresql
</span><span class='line'>  encoding: unicode
</span><span class='line'>  database: rungazella_production
</span><span class='line'>  pool: 5
</span><span class='line'>  password:</span></code></pre></td></tr></table></div></figure></notextile></div></p></li>
<li><p>I entered in config/applications.rb
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>config.assets.initialize_on_precompile = false</span></code></pre></td></tr></table></div></figure></notextile></div>
but i read this is outdated and isn’t used anymore</p></li>
</ul>


<p>I also changed config/environments/production.rb to
<div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>config.serve_static_assets = true</span></code></pre></td></tr></table></div></figure></notextile></div>
not sure if it did anything</p>

<h2>Step 3: Login to heroku</h2>

<ol>
<li>If haven’t already setup a login to heroku. then login with heroku login</li>
<li>heroku create</li>
<li>add postgresql to your app. you can type: heroku addons:add heroku-postgresql but I had to add it within the heroku web interface. add-ons section.</li>
<li>Then use the user-env-compile from heroku labs labs:enable user-env-compile -a my app</li>
</ol>


<h2>Step 4: Final Deploy</h2>

<p>There is currently a known problem with spree and pushing it to heroku.
<a href="https://github.com/spree/spree/issues/3749;">https://github.com/spree/spree/issues/3749;</a> <a href="https://github.com/spree/spree/issues/3688">https://github.com/spree/spree/issues/3688</a>
This means using the user-env-compile (point 4) above and pre-compiling assets before pushing to heroku.
Some info here: <a href="https://devcenter.heroku.com/articles/rails-asset-pipeline">https://devcenter.heroku.com/articles/rails-asset-pipeline</a>
Follow the steps below.</p>

<ol>
<li>bundle exec rake assets:precompile RAILS_ENV=production</li>
<li>git add .</li>
<li>git commit -m “recompiling assets”</li>
<li>git push origin master</li>
<li>git push heroku master</li>
<li>heroku run rake db:migrate &mdash;app my-app</li>
<li>heroku restart &mdash;app my-app</li>
</ol>


<h2>Step 5: Setup the admin user</h2>

<p><div class='bogus-wrapper'><notextile><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>heroku run rails console
</span><span class='line'>user = Spree::User.create!(:email => “&lt;a href="&#109;&#x61;&#x69;&#108;&#x74;&#111;&#x3a;&#97;&#100;&#x6d;&#x69;&#x6e;&#64;&#x72;&#x75;&#110;&#103;&#97;&#x7a;&#x65;&#x6c;&#108;&#x61;&#x2e;&#x63;&#x6f;&#x6d;">&#97;&#x64;&#109;&#x69;&#x6e;&#x40;&#x72;&#117;&#110;&#x67;&#x61;&#x7a;&#x65;&#108;&#108;&#97;&#x2e;&#x63;&#x6f;&#x6d;&lt;/a>", :password => &ldquo;yourpassword&rdquo;)
</span><span class='line'>user.spree_roles.create!(:name => &ldquo;admin&rdquo;)</span></code></pre></td></tr></table></div></figure></notextile></div></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Adventures with Spree Commerce]]></title>
    <link href="http://davwood.github.io/blog/2014/02/27/adventures-with-spree-commerce/"/>
    <updated>2014-02-27T08:43:02+11:00</updated>
    <id>http://davwood.github.io/blog/2014/02/27/adventures-with-spree-commerce</id>
    <content type="html"><![CDATA[<p>I&rsquo;ve been busy lately working on a <a href="http://spreecommerce.com/">Spree</a> E-Commerce site. Spree commerce is an open source ruby on rails project that is very active with lots of users and information. The basic spree gem isn&rsquo;t going to be enough for most people to get a useful site up and running. Fortunately there are lots of extensions that can be added in to get you most of the way there.</p>

<p>In my implementation so far I have used the following gems (in addition to the standard gateway and devise):</p>

<ul>
<li><a href="https://github.com/stefansenk/spree-blogging-spree">spree-blogging-spree</a> &ndash; a simple implementation of a blog within spree. More useful than integrating wordpress for example as it uses a shared database.</li>
<li><a href="https://github.com/spree/spree_editor">spree_editor</a> &ndash; allows a rich text interface for the blog</li>
<li><a href="https://github.com/spree/spree_print_invoice">spree_print_invoice</a> &ndash; allows you to generate (and customise) a PDF invoice. Was surprised that this wasn&rsquo;t standard.</li>
<li><a href="https://github.com/spree/spree_product_zoom">spree_product_zoom</a> &ndash; integrates lightbox zoom functionality so you can show your product images better.</li>
<li><a href="https://github.com/200Creative/spree_bootstrap_frontend">spree_boostrap_frontened</a> &ndash; switches out the skeleton framework used by spree to the bootstrap framework. I used this so I could have better access to all the bootstrap components as I&rsquo;m already familiar will this.</li>
</ul>


<p>I have found Spree to be an excellent project to use but I certainly had a steep learning curve to get up to speed with Spree and then to understand configuring each and every gem to be used above. So would definitely recommend Spree to fellow ruby on rails developers and anyone else if you are keen to learn and have enough time. There is some good documentation on the <a href="http://guides.spreecommerce.com/">Spree</a> site but lacking as you delve too deep.</p>

<p>It is full scale enterprise solution so not something to take on for a quick job.</p>

<p>That said &ndash; it will be a lot quicker next time to begin with the gems above and then create a theme from there.</p>
]]></content>
  </entry>
  
</feed>
