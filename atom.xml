<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Coding Around]]></title>
  <link href="http://davwood.github.io/atom.xml" rel="self"/>
  <link href="http://davwood.github.io/"/>
  <updated>2014-04-14T19:52:22+10:00</updated>
  <id>http://davwood.github.io/</id>
  <author>
    <name><![CDATA[Dave Wood]]></name>
    <email><![CDATA[davwood_1@yahoo.com.au]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Drawing a world map with D3]]></title>
    <link href="http://davwood.github.io/blog/2014/04/09/drawing-a-world-map-with-d3/"/>
    <updated>2014-04-09T08:31:15+10:00</updated>
    <id>http://davwood.github.io/blog/2014/04/09/drawing-a-world-map-with-d3</id>
    <content type="html"><![CDATA[<div id="style"> 
<style type="text/css">

stroke {
  fill: none;
  stroke: #000;
  stroke-width: 2spx;
}

.fill {
  fill: #0D242B;
}

.graticule {
  fill: none;
  stroke: #777;
  stroke-width: .5px;
  stroke-opacity: .3;
}

.country {
  fill: #2D7F99;
}

.country.code32 {fill: #BF3930;} /*Argentina*/
.country.code36 {fill: #BF3930;} /*Australia*/
.country.code40 {fill: #BF3930;} /*Austria*/
.country.code68 {fill: #BF3930;} /*Bolivia*/
.country.code76 {fill: #BF3930;} /*Brazil*/
.country.code84 {fill: #BF3930;} /*Belize*/
.country.code124 {fill: #BF3930;} /*Canada*/
.country.code144 {fill: #BF3930;} /*Sri Lanka*/

.country.code152 {fill: #BF3930;} /*Chile*/
.country.code170 {fill: #BF3930;} /*Colombia*/
.country.code188 {fill: #BF3930;} /*Costa Rica*/
.country.code191 {fill: #BF3930;} /*Croatia*/
.country.code218 {fill: #BF3930;} /*Ecuador*/

.country.code222 {fill: #BF3930;} /*El Salvador*/
.country.code250 {fill: #BF3930;} /*France*/
.country.code276 {fill: #BF3930;} /*Germany*/
.country.code320 {fill: #BF3930;} /*Guatemala*/
.country.code336 {fill: #BF3930;} /*Vatican*/
.country.code340 {fill: #BF3930;} /*Honduras*/

.country.code356 {fill: #BF3930;} /*India*/
.country.code380 {fill: #BF3930;} /*Italy*/
.country.code458 {fill: #BF3930;} /*Malaysia*/
.country.code484 {fill: #BF3930;} /*Mexico*/
.country.code504 {fill: #BF3930;} /*Morocco*/

.country.code524 {fill: #BF3930;} /*Nepal*/
.country.code528 {fill: #BF3930;} /*Netherlands*/
.country.code558 {fill: #BF3930;} /*Nicaragua*/
.country.code578 {fill: #BF3930;} /*Norway*/
.country.code591 {fill: #BF3930;} /*Panama*/

.country.code604 {fill: #BF3930;} /*Peru*/
.country.code620 {fill: #BF3930;} /*Portugal*/
.country.code702 {fill: #BF3930;} /*Singapore*/
.country.code724 {fill: #BF3930;} /*Spain*/
.country.code756 {fill: #BF3930;} /*Switzerland*/

.country.code784 {fill: #BF3930;} /*United Arab Emirates*/
.country.code826 {fill: #BF3930;} /*United Kingdom*/
.country.code840 {fill: #BF3930;} /*United States*/
.country.code858 {fill: #BF3930;} /*Uruguay*/


.boundary {
  fill: none;
  stroke: #fff;
  stroke-width: .5px;
}

</style>

</div>


<div id="world">

</div>




<script type="text/javascript">
    
var width = 840, height = 555;

var svg = d3.select("#world").append("svg")
    .attr("width", width)
    .attr("height", height);

var projection = d3.geo.baker()
    .scale(122)
    .translate([width / 2, height / 2])
    .precision(.1);

var path = d3.geo.path()
    .projection(projection);

var graticule = d3.geo.graticule();

svg.append("defs").append("path")
    .datum({type: "Sphere"})
    .attr("id", "sphere")
    .attr("d", path);

svg.append("use")
    .attr("class", "stroke")
    .attr("xlink:href", "#sphere");

svg.append("use")
    .attr("class", "fill")
    .attr("xlink:href", "#sphere");

svg.append("path")
    .datum(graticule)
    .attr("class", "graticule")
    .attr("d", path);

d3.json("/assets/data/world-50m.json", function(error, world) {

var countries = topojson.feature(world, world.objects.countries).features,
      neighbors = topojson.neighbors(world.objects.countries.geometries);
 
  svg.selectAll(".country")
      .data(countries)
    .enter().insert("path", ".graticule")
      .attr("class", function(d) { return "country " + "code" + d.id; })
      .attr("d", path);

 svg.insert("path", ".graticule")
      .datum(topojson.mesh(world, world.objects.countries, function(a, b) { return a !== b; }))
      .attr("class", "boundary")
      .attr("d", path);
});

d3.select(self.frameElement).style("height", height + "px");

</script>




<p class="subtitle"><em>- Where in the world has davo been</em></p>


<p>I&rsquo;ve started playing around with geographical maps in D3.</p>

<p>It&rsquo;s all quite new to me and there were plenty of new parts to get my head around. Of most use was Mike Bostock&rsquo;s excellent tutorial <a href="http://bost.ocks.org/mike/map/">Let&rsquo;s make a map</a>. It covers all the main points to make a map.</p>

<p>I decided to have a go at a simple task &ndash; representing the countries I&rsquo;ve visited in an elegant D3 map.</p>

<p>The main steps that go into making a map with d3 are:</p>

<h3>1 &ndash; Find and prepare your data</h3>

<p>A world map is made up of a lot of data. The data is used to draw the map as a path in the browser. It will also contain other properties such as place names, population sizes etc.</p>

<p>First choice to get this data seems to be <a href="http://www.naturalearthdata.com/downloads/">natural earth data</a>. It can be downloaded in a range of different formats. I downloaded countries using the 50m resolution (as I didn&rsquo;t need too much detail). This is a zip file containing various formats. The SHP (shapefile) can then be converted to geoJSON and then onto topoJSON. This is needed because D3 deals in geoJSON and topoJSON formats.</p>

<p>You&rsquo;ll need to download GDAL, node.js, topojson.
Full instructions for how to do this are <a href="http://bost.ocks.org/mike/map/#installing-tools">here</a>.</p>

<p>Note: I had to install GDAL from <a href="http://www.kyngchaos.com/software:frameworks">here</a> because after using homebrew it wasn&rsquo;t recognising the ogr2ogr command. After installing GDAL I then had to add to .bash_profile:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>export PATH=/Library/Frameworks/GDAL.framework/Versions/1.10/Programs/:$PATH</span></code></pre></td></tr></table></div></figure>


<h3>2 &ndash; Draw the map</h3>

<p>Once you have the data ready as geoJSON or topoJSON you can then load it into the browser.</p>

<p>The d3.json function takes the json file from where you have saved it on the server.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">d3</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="s2">&quot;/data/world-50m.json&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">world</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">countries</span> <span class="o">=</span> <span class="nx">topojson</span><span class="p">.</span><span class="nx">feature</span><span class="p">(</span><span class="nx">world</span><span class="p">,</span> <span class="nx">world</span><span class="p">.</span><span class="nx">objects</span><span class="p">.</span><span class="nx">countries</span><span class="p">).</span><span class="nx">features</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">svg</span><span class="p">.</span><span class="nx">selectAll</span><span class="p">(</span><span class="s2">&quot;.country&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="nx">countries</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">enter</span><span class="p">().</span><span class="nx">insert</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">,</span> <span class="s2">&quot;.graticule&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="s2">&quot;country &quot;</span> <span class="o">+</span> <span class="s2">&quot;code&quot;</span> <span class="o">+</span> <span class="nx">d</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span> <span class="p">})</span>
</span><span class='line'>      <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">,</span> <span class="nx">path</span><span class="p">);</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>I included the country id in the class as these are <a href="http://en.wikipedia.org/wiki/ISO_3166-1_numeric">numeric ISO codes</a></p>

<p>This could then be used to identify countries.</p>

<h3>3 &ndash; Decide on your projection</h3>

<blockquote><p>A map projection is a systematic transformation of the latitudes and longitudes of locations on the surface of a sphere or an ellipsoid into locations on a plane. Map projections are necessary for creating maps. All map projections distort the surface in some fashion.</p><footer><strong>wiki</strong> <cite><a href='http://en.wikipedia.org/wiki/Map_projection'>en.wikipedia.org/wiki/&hellip;</a></cite></footer></blockquote>


<p>D3 contains lots of different projection options. There are the standard <a href="https://github.com/mbostock/d3/wiki/Geo-Projections">ones</a>.</p>

<table>
<tbody><tr height="146" valign="top">
<td>d3.geo.albersUsa<br><a href="http://bl.ocks.org/mbostock/4090848"><img src="https://camo.githubusercontent.com/2268a4f5bf1729e612c447cdeb39436be58af77c/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f343039303834382f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/4090848/thumbnail.png"></a>
</td>
    <td>d3.geo.azimuthalEqualArea<br><a href="http://bl.ocks.org/mbostock/3757101"><img src="https://camo.githubusercontent.com/2aa03c5f99c72a7775341aa86c8322ae67de8421/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f333735373130312f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/3757101/thumbnail.png"></a>
</td>
    <td>d3.geo.azimuthalEquidistant<br><a href="http://bl.ocks.org/mbostock/3757110"><img src="https://camo.githubusercontent.com/08a3c5189398880d1d3d9f94694afb6dd52e1366/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f333735373131302f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/3757110/thumbnail.png"></a>
</td>
    <td>d3.geo.conicEqualArea<br><a href="http://bl.ocks.org/mbostock/3734308"><img src="https://camo.githubusercontent.com/705780535b279ffc9e48adb93244f1d55b4149b9/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f333733343330382f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/3734308/thumbnail.png"></a>
</td>
  </tr>
<tr height="146" valign="top">
<td>d3.geo.conicConformal<br><a href="http://bl.ocks.org/mbostock/3734321"><img src="https://camo.githubusercontent.com/9a9b004d6d6e99e934a0c59973e27c3b89d00fcb/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f333733343332312f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/3734321/thumbnail.png"></a>
</td>
    <td>d3.geo.conicEquidistant<br><a href="http://bl.ocks.org/mbostock/3734317"><img src="https://camo.githubusercontent.com/3b51bc98fbddeb73e759d6032aa5b53809950ae4/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f333733343331372f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/3734317/thumbnail.png"></a>
</td>
    <td>d3.geo.equirectangular<br><a href="http://bl.ocks.org/mbostock/3757119"><img src="https://camo.githubusercontent.com/510ed66d8c29e34e1010f2167baabd1d01b5fe3b/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f333735373131392f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/3757119/thumbnail.png"></a>
</td>
    <td>d3.geo.gnomonic<br><a href="http://bl.ocks.org/mbostock/3757349"><img src="https://camo.githubusercontent.com/3ed0165a82d5ece1428da8817ab58e36027efb5f/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f333735373334392f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/3757349/thumbnail.png"></a>
</td>
  </tr>
<tr height="146" valign="top">
<td>d3.geo.mercator<br><a href="http://bl.ocks.org/mbostock/3757132"><img src="https://camo.githubusercontent.com/64176495a5d2700fb37d8099f0385774e729ac97/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f333735373133322f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/3757132/thumbnail.png"></a>
</td>
    <td>d3.geo.orthographic<br><a href="http://bl.ocks.org/mbostock/3757125"><img src="https://camo.githubusercontent.com/99ea4d70bc1061f6dc0dacb5c1a8c83eeb19e9fa/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f333735373132352f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/3757125/thumbnail.png"></a>
</td>
    <td>d3.geo.stereographic<br><a href="http://bl.ocks.org/mbostock/3757137"><img src="https://camo.githubusercontent.com/c0c64b059b717a8e523289f71e7a8a28c342082f/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f333735373133372f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/3757137/thumbnail.png"></a>
</td>
    <td>d3.geo.transverseMercator<br><a href="http://bl.ocks.org/mbostock/5126418"><img src="https://camo.githubusercontent.com/b7679bbce2a6db23b4cbcfdcf26163539f68333e/687474703a2f2f626c2e6f636b732e6f72672f6d626f73746f636b2f7261772f353132363431382f7468756d626e61696c2e706e67" width="202" data-canonical-src="http://bl.ocks.org/mbostock/raw/5126418/thumbnail.png"></a>
</td>
  </tr>
</tbody></table>


<p>There is also an extension of different <a href="https://github.com/d3/d3-geo-projection/">projections</a>.</p>

<p>For the map above I used the baker extension. It allows you to scale and translate.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">projection</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">geo</span><span class="p">.</span><span class="nx">baker</span><span class="p">()</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">scale</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">translate</span><span class="p">([</span><span class="nx">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">])</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">precision</span><span class="p">(.</span><span class="mi">1</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<h3>4 &ndash; Styling</h3>

<p>Styling is important to the final product of the map. Since the graphic is in SVG it can be targeted using CSS.</p>

<p>I have added in various basic styling.
I also used CSS to colour in different countries based on the classes I had given them.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nc">.country</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">fill</span><span class="o">:</span> <span class="m">#2D7F99</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nc">.country.code32</span> <span class="p">{</span><span class="n">fill</span><span class="o">:</span> <span class="m">#BF3930</span><span class="p">;}</span> <span class="c">/*Argentina*/</span>
</span><span class='line'><span class="nc">.country.code36</span> <span class="p">{</span><span class="n">fill</span><span class="o">:</span> <span class="m">#BF3930</span><span class="p">;}</span> <span class="c">/*Australia*/</span>
</span><span class='line'><span class="nc">.country.code40</span> <span class="p">{</span><span class="n">fill</span><span class="o">:</span> <span class="m">#BF3930</span><span class="p">;}</span> <span class="c">/*Austria*/</span>
</span><span class='line'><span class="nc">.country.code68</span> <span class="p">{</span><span class="n">fill</span><span class="o">:</span> <span class="m">#BF3930</span><span class="p">;}</span> <span class="c">/*Bolivia*/</span>
</span><span class='line'>
</span><span class='line'><span class="c">/* etc etc */</span>
</span></code></pre></td></tr></table></div></figure>


<p>This was a bit of a shortcut as it may have been easier to update my data in step 1 with the countries I had visited and could then just colour them as a group.</p>

<p>In any case I really like the finished product. Very nice. Now I clearly need to get cracking and travel to Africa and Asia. :)</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[D3 beginnings]]></title>
    <link href="http://davwood.github.io/blog/2014/03/28/d3-beginnings/"/>
    <updated>2014-03-28T14:20:04+11:00</updated>
    <id>http://davwood.github.io/blog/2014/03/28/d3-beginnings</id>
    <content type="html"><![CDATA[



<h1 id="d3heading">
  <svg id="d3header" width="96" height="91" style="position:relative;top:22px;">
    <linearGradient id="logo-gradient-1" gradientUnits="userSpaceOnUse" x1="37.2417" y1="7.0552" x2="97.9669" y2="67.7803">
      <stop offset="0" stop-color="#F9A03C"/>
      <stop offset="1" stop-color="#F7974E"/>
    </linearGradient>
    <linearGradient id="logo-gradient-2" gradientUnits="userSpaceOnUse" x1="-8.0391" y1="17.2148" x2="45.724" y2="70.978">
      <stop offset="0" stop-color="#F9A03C"/>
      <stop offset="1" stop-color="#F7974E"/>
    </linearGradient>
    <linearGradient id="logo-gradient-3" gradientUnits="userSpaceOnUse" x1="11.9321" y1="36.5513" x2="66.3901" y2="91.0092">
      <stop offset="0" stop-color="#F9A03C"/>
      <stop offset="1" stop-color="#F7974E"/>
    </linearGradient>
    <linearGradient id="logo-gradient-4" gradientUnits="userSpaceOnUse" x1="1.6533" y1="-1.6533" x2="86.899" y2="83.5924">
      <stop offset="0" stop-color="#F26D58"/>
      <stop offset="1" stop-color="#F9A03C"/>
    </linearGradient>
    <linearGradient id="logo-gradient-5" gradientUnits="userSpaceOnUse" x1="45.2446" y1="-9.5483" x2="108.0998" y2="53.3068">
      <stop offset="0" stop-color="#B84E51"/>
      <stop offset="1" stop-color="#F68E48"/>
    </linearGradient>
    <linearGradient id="logo-gradient-6" gradientUnits="userSpaceOnUse" x1="6.6323" y1="64.3193" x2="49.6788" y2="107.3658">
      <stop offset="0" stop-color="#F9A03C"/>
      <stop offset="1" stop-color="#F7974E"/>
    </linearGradient>
    <path fill="url(#logo-gradient-1)" d="M95.82,65.857c0.043-0.418,0.074-0.84,0.098-1.264c0.029-0.502-30.211-29.194-30.211-29.194h-0.723C64.984,35.399,95.635,67.73,95.82,65.857z"/>
    <path fill="url(#logo-gradient-2)" d="M31.302,55.904c-0.04,0.088-0.08,0.176-0.121,0.264c-0.043,0.092-0.087,0.184-0.131,0.275c-0.964,2.01,13.495,16.145,14.658,14.428c0.053-0.076,0.106-0.156,0.159-0.232c0.059-0.09,0.117-0.176,0.175-0.266C46.972,68.961,31.715,54.986,31.302,55.904z"/>
    <path fill="url(#logo-gradient-3)" d="M51.734,75.781c-0.041,0.09-0.332,0.582-0.598,0.842c-0.045,0.09,14.115,14.133,14.115,14.133h1.275C66.527,90.756,53.234,76.375,51.734,75.781z"/>
    <path fill="url(#logo-gradient-4)" d="M95.938,64.338c-0.662,14.68-12.807,26.418-27.645,26.418h-2.006L51.469,76.158c1.219-1.719,2.352-3.5,3.361-5.357h13.463c4.258,0,7.723-3.463,7.723-7.723c0-4.258-3.465-7.723-7.723-7.723h-7.967c0.607-3.209,0.939-6.518,0.939-9.903c0-3.437-0.338-6.793-0.967-10.053h4.949l30.604,30.155C95.887,65.15,95.916,64.746,95.938,64.338z M8.05,0H0v19.955h8.05c14.06,0,25.5,11.437,25.5,25.497c0,3.825-0.853,7.456-2.369,10.716l14.686,14.471c4.822-7.215,7.641-15.877,7.641-25.187C53.508,20.39,33.115,0,8.05,0z"/>
    <path fill="url(#logo-gradient-5)" d="M68.293,0H35.695c7.962,4.861,14.555,11.754,19.047,19.955h13.551c4.258,0,7.723,3.463,7.723,7.723c0,4.259-3.465,7.722-7.723,7.722h-3.045l30.604,30.155c0.072-0.818,0.117-1.641,0.117-2.477c0-6.727-2.414-12.898-6.422-17.701c4.008-4.801,6.422-10.973,6.422-17.699C95.969,12.417,83.555,0,68.293,0z"/>
    <path fill="url(#logo-gradient-6)" d="M66.287,90.756H35.928C42.039,86.982,47.322,82,51.469,76.158L66.287,90.756z M45.867,70.639L31.182,56.168C27.125,64.887,18.284,70.951,8.05,70.951H0v19.953h8.05C23.804,90.904,37.709,82.846,45.867,70.639z"/>
  </svg>
  Data-Driven Documents
</h1>




<p></p>


<p>I&rsquo;m currently using <a href="http://d3js.org">d3.js</a> to play around with some data and produce visualisations. It is an awesome javascript library from <a href="http://bost.ocks.org/mike/">Mike Bostock</a> who is one of the main guys behind the great visualisations you see at the <a href="http://www.nytimes.com/newsgraphics/2013/12/30/year-in-interactive-storytelling/">New York Times</a>. He seems to be a prolific producer of work. Between github, google groups, other forums, and holding down a day job &ndash; he must be a busy guy.</p>

<p>I highly recommend you check <a href="http://d3js.org">it</a> out. I&rsquo;ll be posting some d3 examples here shortly.
Check out my initial play with a line chart <a href="http://davwood.github.io/blog/2014/01/18/makers-academy-rewound/">here.</a></p>

<p>Also notice the D3 image above. It is from the main <a href="http://d3js.org">d3</a> page and is written entirely in SVG. Pretty cool.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Setting up Spree to play with Amazon S3]]></title>
    <link href="http://davwood.github.io/blog/2014/03/22/setting-up-spree-to-play-wth-amazon-s3/"/>
    <updated>2014-03-22T10:23:01+11:00</updated>
    <id>http://davwood.github.io/blog/2014/03/22/setting-up-spree-to-play-wth-amazon-s3</id>
    <content type="html"><![CDATA[<p><img src="http://davwood.github.io/blog/images/amazon-river.jpg" /></p>

<p>S3 is needed to host images when using heroku or other similar services (like ninefold). This is because heroku’s filesystem is readonly, so when uploading images (except with deploy) we need to use an off-site sever such as S3.</p>

<p>Spree used to have S3 configurable as part of the admin back end.
However, Spree in 2-2-stable has now dropped this integration.
<a href="https://github.com/spree/spree/commit/b1d6c5e4b9801d888cc76c05116b814945122207">https://github.com/spree/spree/commit/b1d6c5e4b9801d888cc76c05116b814945122207</a>
We must refer to the paperclip documentation instead.
<a href="https://github.com/thoughtbot/paperclip">https://github.com/thoughtbot/paperclip</a></p>

<p>But spree has some config options available within initializers/spree.rb
see below:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Spree</span><span class="o">.</span><span class="n">config</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span><span class='line'>       <span class="c1"># Example:</span>
</span><span class='line'>       <span class="c1"># Uncomment to override the default site name.</span>
</span><span class='line'>       <span class="n">config</span><span class="o">.</span><span class="n">site_name</span> <span class="o">=</span> <span class="s2">&quot;Gazella Running Costumes&quot;</span>
</span><span class='line'>       <span class="n">config</span><span class="o">.</span><span class="n">logo</span> <span class="o">=</span> <span class="s2">&quot;store/rungazella.png&quot;</span>
</span><span class='line'>
</span><span class='line'>      <span class="c1">#S3 configuration</span>
</span><span class='line'>      <span class="k">if</span> <span class="no">Rails</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">production?</span> <span class="k">then</span>
</span><span class='line'>           <span class="c1">#production. Store images on S3.</span>
</span><span class='line'>           <span class="c1"># development will default to local storage</span>
</span><span class='line'>          <span class="n">attachment_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>          <span class="n">s3_credentials</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="n">access_key_id</span><span class="p">:</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_KEY&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>            <span class="n">secret_access_key</span><span class="p">:</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_SECRET&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>            <span class="ss">bucket</span><span class="p">:</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_BUCKET&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>          <span class="p">},</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>          <span class="ss">storage</span><span class="p">:</span>        <span class="ss">:s3</span><span class="p">,</span>
</span><span class='line'>          <span class="n">s3_headers</span><span class="p">:</span>     <span class="p">{</span> <span class="s2">&quot;Cache-Control&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;max-age=31557600&quot;</span> <span class="p">},</span>
</span><span class='line'>          <span class="n">s3_protocol</span><span class="p">:</span>    <span class="s2">&quot;https&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="ss">bucket</span><span class="p">:</span>         <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_BUCKET&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>          <span class="ss">path</span><span class="p">:</span>          <span class="s2">&quot;:rails_root/public/:class/:attachment/:id/:style/:basename.:extension&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="n">default_url</span><span class="p">:</span>   <span class="s2">&quot;/:class/:attachment/:id/:style/:basename.:extension&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="n">default_style</span><span class="p">:</span> <span class="s2">&quot;product&quot;</span><span class="p">,</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>          <span class="n">attachment_config</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
</span><span class='line'>               <span class="ss">Spree</span><span class="p">:</span><span class="ss">:Image</span><span class="o">.</span><span class="n">attachment_definitions</span><span class="o">[</span><span class="ss">:attachment</span><span class="o">][</span><span class="n">key</span><span class="o">.</span><span class="n">to_sym</span><span class="o">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>     <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="no">Spree</span><span class="o">.</span><span class="n">user_class</span> <span class="o">=</span> <span class="s2">&quot;Spree::User&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>note: the environmental variables were then added to heroku using</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>heroku config:set S3_KEY=your_access_key
</span><span class='line'>heroku config:set S3_SECRET=your_secret_key
</span><span class='line'>heroku config:set S3_BUCKET=your_bucket_name</span></code></pre></td></tr></table></div></figure>


<h3>Additional Notes:</h3>

<p>Update to the paperclip defaults for image sizes
<a href="http://guides.spreecommerce.com/developer/logic.html">http://guides.spreecommerce.com/developer/logic.html</a></p>

<p>To change the paperclip defaults for image sizes I created the file app/models/spree/image_decorator.rb. And added this:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">Spree</span><span class="p">:</span><span class="ss">:Image</span><span class="o">.</span><span class="n">class_eval</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">attachment_definitions</span><span class="o">[</span><span class="ss">:attachment</span><span class="o">][</span><span class="ss">:styles</span><span class="o">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="ss">mini</span><span class="p">:</span>     <span class="s2">&quot;50x60&gt;&quot;</span><span class="p">,</span> <span class="c1">#used for the thumbnails</span>
</span><span class='line'>  <span class="ss">small</span><span class="p">:</span>    <span class="s2">&quot;120x144&gt;&quot;</span><span class="p">,</span> <span class="c1">#used for the product listing</span>
</span><span class='line'>  <span class="ss">product</span><span class="p">:</span>  <span class="s2">&quot;300x361&gt;&quot;</span><span class="p">,</span> <span class="c1">#used for the main product page</span>
</span><span class='line'>  <span class="ss">large</span><span class="p">:</span>    <span class="s2">&quot;700x841&gt;&quot;</span> <span class="c1">#could be used for hovering</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h2>Uploading Images with Ckeditor</h2>

<p>I had naively thought that updating the above would allow also work for the blog I had added to my site using the <a href="https://github.com/stefansenk/spree-blogging-spree">spree-blogging-spree</a> gem. Unfortunately ckeditor didn&rsquo;t recognise spree straight away but it can be configured with paperclip.</p>

<p>Based on this I could update app/models/ckeditor/picture.rb to:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Ckeditor</span><span class="o">::</span><span class="no">Picture</span> <span class="o">&lt;</span> <span class="ss">Ckeditor</span><span class="p">:</span><span class="ss">:Asset</span>
</span><span class='line'>  <span class="n">has_attached_file</span> <span class="ss">:data</span><span class="p">,</span>
</span><span class='line'>                    <span class="ss">styles</span><span class="p">:</span> <span class="p">{</span> <span class="ss">:content</span> <span class="o">=&gt;</span> <span class="s1">&#39;600&gt;&#39;</span><span class="p">,</span> <span class="ss">:thumb</span> <span class="o">=&gt;</span> <span class="s1">&#39;118x100#&#39;</span> <span class="p">},</span>
</span><span class='line'>   <span class="n">s3_credentials</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">access_key_id</span><span class="p">:</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_KEY&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>        <span class="n">secret_access_key</span><span class="p">:</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_SECRET&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>        <span class="ss">bucket</span><span class="p">:</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_BUCKET&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>      <span class="p">},</span>
</span><span class='line'>  <span class="ss">storage</span><span class="p">:</span> <span class="ss">:s3</span><span class="p">,</span>
</span><span class='line'>  <span class="n">s3_headers</span><span class="p">:</span>     <span class="p">{</span> <span class="s2">&quot;Cache-Control&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;max-age=31557600&quot;</span> <span class="p">},</span>
</span><span class='line'>  <span class="n">s3_protocol</span><span class="p">:</span>    <span class="s2">&quot;https&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">bucket</span><span class="p">:</span>         <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;S3_BUCKET&quot;</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>    <span class="ss">path</span><span class="p">:</span> <span class="s2">&quot;/:class/:attachment/:id/:style/:basename.:extension&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="n">default_url</span><span class="p">:</span>   <span class="s2">&quot;/:class/:attachment/:id/:style/:basename.:extension&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="n">default_style</span><span class="p">:</span> <span class="s2">&quot;medium&quot;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">validates_attachment_size</span> <span class="ss">:data</span><span class="p">,</span> <span class="ss">:less_than</span> <span class="o">=&gt;</span> <span class="mi">2</span><span class="o">.</span><span class="n">megabytes</span>
</span><span class='line'>  <span class="n">validates_attachment_presence</span> <span class="ss">:data</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">url_content</span>
</span><span class='line'>    <span class="n">url</span><span class="p">(</span><span class="ss">:content</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Getting a Spree Site onto Heroku]]></title>
    <link href="http://davwood.github.io/blog/2014/03/10/getting-a-spree-site-onto-heroku/"/>
    <updated>2014-03-10T09:29:44+11:00</updated>
    <id>http://davwood.github.io/blog/2014/03/10/getting-a-spree-site-onto-heroku</id>
    <content type="html"><![CDATA[<p>I had a great Spree E-commerce working fine on the localhost &ndash; and then I needed to get it onto heroku. Easy right? As someone who has used heroku a few times before (but not for a little while) I remembered it was pretty much a simple case of &lsquo;git push heroku master&rsquo;. Nope!!</p>

<p>Below is some coverage of what I needed to do. Hopefully it can be of use.</p>

<p>This was using spree branch &lsquo;2-2-stable&rsquo; with a postgresql database.</p>

<h2>Step 1: Update the web server to unicorn</h2>

<p>Add the gem &lsquo;unicorn&rsquo; and create a file &lsquo;config/unicorn.rb&rsquo;. The put the below into the file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="n">worker_processes</span> <span class="nb">Integer</span><span class="p">(</span><span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;WEB_CONCURRENCY&quot;</span><span class="o">]</span> <span class="o">||</span> <span class="mi">3</span><span class="p">)</span>
</span><span class='line'>  <span class="n">timeout</span>
</span><span class='line'>  <span class="n">timeout</span> <span class="mi">15</span>
</span><span class='line'>  <span class="n">preload_app</span> <span class="kp">true</span>
</span><span class='line'>  <span class="n">before_fork</span> <span class="k">do</span> <span class="o">|</span><span class="n">server</span><span class="p">,</span> <span class="n">worker</span><span class="o">|</span>
</span><span class='line'>    <span class="no">Signal</span><span class="o">.</span><span class="n">trap</span> <span class="s1">&#39;TERM&#39;</span> <span class="k">do</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s1">&#39;Unicorn master intercepting TERM and sending myself QUIT instead&#39;</span>
</span><span class='line'>      <span class="no">Process</span><span class="o">.</span><span class="n">kill</span> <span class="s1">&#39;QUIT&#39;</span><span class="p">,</span> <span class="no">Process</span><span class="o">.</span><span class="n">pid</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">defined?</span><span class="p">(</span><span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="p">)</span> <span class="ow">and</span>
</span><span class='line'>      <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">disconnect!</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">after_fork</span> <span class="k">do</span> <span class="o">|</span><span class="n">server</span><span class="p">,</span> <span class="n">worker</span><span class="o">|</span>
</span><span class='line'>    <span class="no">Signal</span><span class="o">.</span><span class="n">trap</span> <span class="s1">&#39;TERM&#39;</span> <span class="k">do</span>
</span><span class='line'>      <span class="nb">puts</span> <span class="s1">&#39;Unicorn worker intercepting TERM and doing nothing. Wait for master to send QUIT&#39;</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">defined?</span><span class="p">(</span><span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="p">)</span> <span class="ow">and</span>
</span><span class='line'>      <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">establish_connection</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>create a Procfile in the root directory</li>
<li>in the Procfile write:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>web: bundle exec unicorn -p $PORT -c ./config/unicorn.rb</span></code></pre></td></tr></table></div></figure>


<ul>
<li>create a .env file to hold environment variables and add it to .gitignore!</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>echo "RACK_ENV=development" >>.env
</span><span class='line'>echo "PORT=3000" >> .env
</span><span class='line'>echo ".env" >> .gitignore
</span><span class='line'>git add .gitignore
</span><span class='line'>git commit -m "add .env to .gitignore"</span></code></pre></td></tr></table></div></figure>


<ul>
<li>gem install foreman</li>
<li>foreman start</li>
</ul>


<p>Now running unicorn! :)</p>

<h2>Step 2: Rails App Config Updates</h2>

<ul>
<li>Remove username from database.yml
Production looks like:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>production:
</span><span class='line'>  adapter: postgresql
</span><span class='line'>  encoding: unicode
</span><span class='line'>  database: rungazella_production
</span><span class='line'>  pool: 5
</span><span class='line'>  password:</span></code></pre></td></tr></table></div></figure>


<ul>
<li>I entered in config/applications.rb</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>config.assets.initialize_on_precompile = false</span></code></pre></td></tr></table></div></figure>


<p>but i read this is outdated and isn’t used anymore</p>

<p>I also changed config/environments/production.rb to</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>config.serve_static_assets = true</span></code></pre></td></tr></table></div></figure>


<p>not sure if it did anything</p>

<h2>Step 3: Login to heroku</h2>

<ol>
<li>If haven’t already setup a login to heroku. then login with heroku login</li>
<li>heroku create</li>
<li>add postgresql to your app. you can type: heroku addons:add heroku-postgresql but I had to add it within the heroku web interface. add-ons section.</li>
<li>Then use the user-env-compile from heroku labs labs:enable user-env-compile -a my app</li>
</ol>


<h2>Step 4: Final Deploy</h2>

<p>There is currently a known problem with spree and pushing it to heroku.
<a href="https://github.com/spree/spree/issues/3749;">https://github.com/spree/spree/issues/3749;</a> <a href="https://github.com/spree/spree/issues/3688">https://github.com/spree/spree/issues/3688</a>
This means using the user-env-compile (point 4) above and pre-compiling assets before pushing to heroku.
Some info here: <a href="https://devcenter.heroku.com/articles/rails-asset-pipeline">https://devcenter.heroku.com/articles/rails-asset-pipeline</a>
Follow the steps below.</p>

<ol>
<li>bundle exec rake assets:precompile RAILS_ENV=production</li>
<li>git add .</li>
<li>git commit -m “recompiling assets”</li>
<li>git push origin master</li>
<li>git push heroku master</li>
<li>heroku run rake db:migrate &mdash;app my-app</li>
<li>heroku restart &mdash;app my-app</li>
</ol>


<h2>Step 5: Setup the admin user</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>heroku run rails console
</span><span class='line'>user = Spree::User.create!(:email => “admin@rungazella.com", :password => "yourpassword")
</span><span class='line'>user.spree_roles.create!(:name => "admin")</span></code></pre></td></tr></table></div></figure>



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Adventures with Spree Commerce]]></title>
    <link href="http://davwood.github.io/blog/2014/02/27/adventures-with-spree-commerce/"/>
    <updated>2014-02-27T08:43:02+11:00</updated>
    <id>http://davwood.github.io/blog/2014/02/27/adventures-with-spree-commerce</id>
    <content type="html"><![CDATA[<p>I&rsquo;ve been busy lately working on a <a href="http://spreecommerce.com/">Spree</a> E-Commerce site. Spree commerce is an open source ruby on rails project that is very active with lots of users and information. The basic spree gem isn&rsquo;t going to be enough for most people to get a useful site up and running. Fortunately there are lots of extensions that can be added in to get you most of the way there.</p>

<p>In my implementation so far I have used the following gems (in addition to the standard gateway and devise):</p>

<ul>
<li><a href="https://github.com/stefansenk/spree-blogging-spree">spree-blogging-spree</a> &ndash; a simple implementation of a blog within spree. More useful than integrating wordpress for example as it uses a shared database.</li>
<li><a href="https://github.com/spree/spree_editor">spree_editor</a> &ndash; allows a rich text interface for the blog</li>
<li><a href="https://github.com/spree/spree_print_invoice">spree_print_invoice</a> &ndash; allows you to generate (and customise) a PDF invoice. Was surprised that this wasn&rsquo;t standard.</li>
<li><a href="https://github.com/spree/spree_product_zoom">spree_product_zoom</a> &ndash; integrates lightbox zoom functionality so you can show your product images better.</li>
<li><a href="https://github.com/200Creative/spree_bootstrap_frontend">spree_boostrap_frontened</a> &ndash; switches out the skeleton framework used by spree to the bootstrap framework. I used this so I could have better access to all the bootstrap components as I&rsquo;m already familiar will this.</li>
</ul>


<p>I have found Spree to be an excellent project to use but I certainly had a steep learning curve to get up to speed with Spree and then to understand configuring each and every gem to be used above. So would definitely recommend Spree to fellow ruby on rails developers and anyone else if you are keen to learn and have enough time. There is some good documentation on the <a href="http://guides.spreecommerce.com/">Spree</a> site but lacking as you delve too deep.</p>

<p>It is full scale enterprise solution so not something to take on for a quick job.</p>

<p>That said &ndash; it will be a lot quicker next time to begin with the gems above and then create a theme from there.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Makers Academy Rewound]]></title>
    <link href="http://davwood.github.io/blog/2014/01/18/makers-academy-rewound/"/>
    <updated>2014-01-18T20:55:03+11:00</updated>
    <id>http://davwood.github.io/blog/2014/01/18/makers-academy-rewound</id>
    <content type="html"><![CDATA[<div id="style">              
    

<style type="text/css">
.svg-section {
    background-color: #25383C;
}

text#green {
    fill: white;
    font-size: 12px;
}

text#red {
    fill: white;
    font-size: 12px;
}
.axis path,
.axis line {
  shape-rendering: crispEdges;
}


.x.axis path {
  display: none;
}

.line {
  fill: none;
  stroke: url(#col-gradient);
  stroke-width: 2px;
}

.axis .domain
{
opacity: 0;
}


.tick {
    fill: white;
}

.tick line {
    stroke: white;
}

#weeks {
    font-size: 14px; 
    fill: white;

}

rect {
    opacity: 0.5;
    stroke: grey;
}

.subtitle {
    font-size: 0.9em;
    padding-left: 10px;
}

#option {
    margin-bottom: 15px;
}
</style>
</div>


<div id="option">
    <input name="updateButton" 
                 type="button" 
                value="Update" 
                onclick="redrawLine()" />
</div>


<div id="body">
</div>


<p></p>

<script type="text/javascript">

function draw() {

$("#body").empty();

var margin = {top: 20, right: 25, bottom: 50, left: 100},
    width = 660 - margin.left - margin.right,
    height = 260 - margin.top - margin.bottom;

// var parseDate = d3.time.format("%d-%b-%y").parse;


var data = [5,8,6,3,6,4,5,8,3,2,3,7,9]

var x = d3.scale.linear()
    .domain([0, data.length - 1])
    .range([0, width]);

var y = d3.scale.linear()
    .domain([0,d3.max(data)])
    .range([height, 0]);

var xAxis = d3.svg.axis()
    .scale(x)
    .tickSize(5)
    .orient("bottom");

var yAxis = d3.svg.axis()
    .scale(y)
    .ticks(1)
    .tickFormat(function (d) { return ''; }) //hides the tick value
    .tickSize(10)
    .orient("left")
    

var line = d3.svg.line()
    .interpolate("cardinal")
    .x(function(d,i) { return x(i); })
    .y(function(d) { return y(d); });

var svg = d3.select("#body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .attr("class", "svg-section")
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

svg.append("linearGradient")
      .attr("id", "col-gradient")
      .attr("gradientUnits", "userSpaceOnUse")
      .attr("x1", 0).attr("y1", y(3))
      .attr("x2", 0).attr("y2", y(6))
    .selectAll("stop")
      .data([
        {offset: "0%", color: "red"},
        {offset: "50%", color: "orange"},
        {offset: "100%", color: "green"}
      ])
    .enter().append("stop")
      .attr("offset", function(d) { return d.offset; })
      .attr("stop-color", function(d) { return d.color; });


//Draw XAxis
  svg.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis)
    .append("text")
      .attr("x", width/2)
      .attr("y", "30")
      .attr("dy", "0.71em")
      .attr("id", "weeks")
      .style("text-anchor", "middle")
      .text("Weeks");

//Draw YAxis
var yAxisdraw = svg.append("g")
      .attr("class", "y axis")
      .call(yAxis)

yAxisdraw.append("rect")
    .attr("width", 95)
    .attr("height", 40)
    .attr("x", -90)
    .attr("y", height-70)
    .style("fill", "red")

yAxisdraw.append("text")
      .attr("y", height-55)
      .attr("x",-2)
      .attr("dy", ".71em")
      .attr("id", "red")
      .style("text-anchor", "end")
      .text("I know nothing");

yAxisdraw.append("rect")
    .attr("width", 95)
    .attr("height", 40)
    .attr("x", -90)
    .attr("y", 25)
    .style("fill", "green")

yAxisdraw.append("text")
      .attr("y", 40)
      .attr("x", -15)
      .attr("dy", ".71em")
      .attr("id", "green")
      .style("text-anchor", "end")
      .text("I know lots");



var path = svg.append("path")
      .datum(data)
      .attr("class", "line")
      .attr("d", line);

var totalLength = path.node().getTotalLength();
  
path
      .attr("stroke-dasharray", totalLength+","+totalLength)
      .attr("stroke-dashoffset", totalLength)
      .transition()
      .duration(2500)
      .ease("linear-in-out")
      .attr("stroke-dashoffset", 0);

}

draw();

function redrawLine() {
  draw();
}

// $(window).resize(function() {
//   draw();
// });

   
</script>




<p class="subtitle"><em>- The ups and downs of learning at Makers Academy :)</em></p>




<br>


<p>We had 2 weeks. 2 weeks to build a web application. A good web application. One that attempted to solve a problem. One that was usable, looked ok, with limited &lsquo;technical debt&rsquo; and developed using test-driven development (TDD) principles. One that we would present (in our team of 5) in front of 150 people. Woo and dazzle them. Be so good that we all get acquired by google for millions of pounds.<br/>
Well.. maybe not quite the last line but it cetainly seemed like I wasn&rsquo;t going to be doing much else in the next 2 weeks.</p>

<p>It was the final 2 weeks of the <a href="www.makersacademy.com">Makers Academy</a> course &ndash; a 12 week intensive web development course in London. A course that had been relentless in the amount of new material being thrown around each and every day. A constant battle to try and stay up on it. To try not to sink. A regular battle where you just felt like you were starting to catch up and kind of &lsquo;get it&rsquo; &ndash; only to then be blind-sided by a whole bunch of new information, concepts and ideas.</p>

<p>Of course don&rsquo;t get me wrong &ndash; it was still fun. It was a great environment to learn with a ping pong table, muesli bars, lots of coffee and plenty of jokes. Hearing a german in a heavy accent tell everyone he was going to &lsquo;fork it&rsquo; (in reference to his git account) meant I was now also well up to speed on nerdy jokes.</p>

<h3>A Normal Day</h3>

<p>A normal day went something like this:</p>

<ul>
<li>9am &ndash; arrive</li>
<li>9:30am &ndash; morning &lsquo;lecture&rsquo;</li>
<li>11am &ndash; coffee walk (we often went to Ozone coffee)</li>
<li>11:15am &ndash; start coding based on what we&rsquo;d covered in the morning</li>
<li>1pm &ndash; take lunch. ping pong championships</li>
<li>2pm &ndash; get back to coding practice</li>
<li>3pm &ndash; maybe an afternoon &lsquo;lecture&rsquo; or a Q &amp; A session</li>
<li>4pm &ndash; keep going with whatever your working</li>
<li>7pm &ndash; leave (it was common to do some at home too)</li>
</ul>


<p><em>Makers Academy was generally open from around 8:30am &ndash; 9pm so you could stay back if you wanted to.</em></p>

<p><img src="http://davwood.github.io/blog/images/makersacademy.png" /></p>

<h3>Fridays</h3>

<p>Each Friday was a test day. Basically you got given a challenge based around what you&rsquo;d been learning that week. These ranged from short 1 hour challenges right through to building a site over the course of the weekend. It helped to just focus on the learning aspect rather than the exact outcome especially because some of the websites were too big to do in a weekend so you just had to get done what you could. I enjoyed them on the whole as it let you go at your own pace, reinforce the material and give you a reasonable idea as to how your were tracking. It was all &lsquo;open internet&rsquo;, so you could search for what you want &ndash; just don&rsquo;t go fooling yourself and copying too much.</p>

<h3>Our Cohort</h3>

<p>All 15 of us in the group were in this together and helped and supported each other throughout. We regularly pair programmed and switched pairs often. We had started in the August cohort bright and energetic quickly overcoming that momentary awkwardness of a new group of people. There were lots of different backgrounds. University graduates, accountant, entrepreneur, poet, venture capitalist, scientist, theatre manager to name a few. Different ages too. 19 yrs old &ndash; right up to 40yrs+ all with different motivations for being there but a common goal to learn. Looking back I think we were a particularly lucky group as we all fitted together better than normal. Not sure why exactly &ndash; maybe a good girl / guy ratio helped. Maybe because we could bring different perspectives to the table from our different backgrounds.</p>

<h3>Learning style</h3>

<p>We worked through an evolving syllabus that was up to date with the latest in web technologies. We would cover a general topic (javascript for example) for a week and do exercises relating to it often culminating in a small project. Due to the interlinked nature of the things we were learning it was all meant to build on top of each other. So learning git (a version control system) early on was then a skill that we used daily from then on. Teacher interaction was through a combination of group lectures, Q &amp; A lectures, a hackpad online resource and questions. We ended with a system of writing our name on the board (a very non-tech queuing system!) that the teacher would then come around and deal with the issues you had. This worked well most of the time. Often a fellow student could help you out also and sometimes a game of ping pong was all that was needed to change focus and come back to the problem to discovered you were missing a dot!</p>

<p>Special mention to our teachers throughout this whole 12 weeks. <a href="https://github.com/shadchnev">Evgeny</a> started us out, <a href="https://github.com/ecomba">Enrique</a> kicked us along and <a href="https://github.com/alexpeattie">Alex</a> brought us home in a calm, composed flurry.  I was particularly impressed by the selfless attitude of the teachers. They were genuinely interested in helping you and were quite happy to keep going back over things again and again until you got it.  A very different attitude to those bored lecturers at university or people training you at a bank who are just a bit tired of their job.</p>

<p>The teachers at <a href="www.makersacademy.com">Makers Academy</a> definitely love what they do and it shows. It helps that Makers Academy is a new startup (about a year old) and is flexible with change and open to new ideas. I hope they become rigid in future as the business matures.</p>

<p><strong>I would highly recommend this course to someone who is keen to learn and wants to work hard. You just have to be willing to dig deep and push out of your comfort zone.</strong></p>

<p>Like many things this definitely falls into the category of the more you put into it the more you&rsquo;ll get out of it. Oh and tell your partner you might be a bit busy so they should take up knitting and/or golf!</p>

<p>If you&rsquo;re interested our final 2 week project was <a href="http://www.setforget.it">Set it forget it</a>.</p>

<h3>Afterwards (and Jobs)</h3>

<p>There were 2 broad groups of people at the course.</p>

<ol>
<li>Those looking for Junior web development roles</li>
<li>Everyone else</li>
</ol>


<p>For those in group 1 that were looking for web development roles they have largely found them. Many got jobs withing the first 2 months of looking. Some who feel they are not quite up to scratch are continuing to practice at home. There are plenty of jobs out there in the field. However, some employers will take some convincing that someone after just 12 weeks is worth hiring. <a href="www.makersacademy.com">Makers Academy</a> is trying to help convince them by bringing them along to events to see for themselves and pair programming with students to see what we know.</p>

<p>For group 2 &ndash; everyone was pretty happy with the course and I think most people got out of the course what they wanted.</p>

<p>For me personally, I have moved back to Australia (after 5 years away) and have been enjoying sunshine, beaches, catching up with family and friends. My coding took a break for a few weeks (I also dropped into say hello to friends in America) but am now back on the horse and working on a few projects of my own so I&rsquo;m somewhere between groups 1 &amp; 2. Will be looking for some web development work soon!</p>

<p>Have starting learning <a href="http://d3js.org/">d3.js</a>. I&rsquo;ve used in the chart at the top. It&rsquo;s one of the things I&rsquo;m hoping to progress further with.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Journeying into the world of web development]]></title>
    <link href="http://davwood.github.io/blog/2014/01/15/journeying-into-the-world-of-web-development/"/>
    <updated>2014-01-15T16:56:15+11:00</updated>
    <id>http://davwood.github.io/blog/2014/01/15/journeying-into-the-world-of-web-development</id>
    <content type="html"><![CDATA[<p>So&hellip; I&rsquo;ve been meaning to write a post to reflect just a bit on what the hell happened last year.</p>

<p>I was sailing along in a comfortable corporate job in London. Life was pretty good. Taking trips here and there (Paris one week &ndash; Morocco the next) and then I decided enough was enough. I quit.</p>

<p>I won&rsquo;t pretend it was a surprise. Not something I decided on emotionally, quickly, self-righteously in a moment of clarity. No. I had been uncomfortable with the situation for a long time. Slowly being lulled into inaction by the rhythm of a steady paycheck and the acknowledgement that everyone else was doing it. And that it was all &ldquo;normal&rdquo;. It was &ldquo;Ok&rdquo;. Just ok &ndash; but not great. So anyway &ndash; I was sick of dealing with just Ok.</p>

<p>As I handed in the resignation I got the usual questions.</p>

<p><em>&ldquo;Which company are you going to?&rdquo;</em> <br>
<em>&ldquo;Are they paying you more?&rdquo;</em> <br>
<em>&ldquo;Can we pay you more?&rdquo;</em></p>

<p>All I could adequately come up with was some vague notion of &ldquo;travelling&rdquo; which was enough of a reason for many. It then often summoned a certain amount of envy in certain people and surprisingly often ended with a fierce (but unnecessary) declaration of the fact they&rsquo;d love to do that too but had lots of reason why it was just not possible!</p>

<p><em>&ldquo;I&rsquo;d love to do that!.. But I have kids!&rdquo;</em> <br>
<em>&ldquo;But I have a mortgage&rdquo;</em> <br>
<em>&ldquo;But I might get a manager job&rdquo;</em></p>

<p>So anyway, we (my girlfriend and I) eventually worked out what the travelling would be. Cycling. London to Paris and then onto Spain. Adventure. And it was awesome.</p>

<p><img src="http://davwood.github.io/blog/images/cycle-france.png" /></p>

<p>Of course, this was a bit of a distraction. I needed to decide what was really next. What was going to better than just ok. In 10 years of corporate climbing I&rsquo;d learnt a lot. How to push the boundaries without getting your head knocked off. How to stand out a bit but not too much. How to do the job well.</p>

<p>My role had been as a business analyst. The guy who sits on projects and tries to bridge the gap between the business guys and the IT people. These things often morphed into huge expensive projects with a complex hierarchical system where it can get difficult to get things done.</p>

<p>In the midst of this I often felt a great sense of impotence into not being able to just get things done. My lack of coding knowledge meant that I was always going to have to outsource projects to others. I have always been someone who is keen to learn new things and so I started to try some coding. Of course this began with some MS Excel VBA work but struggled to progress far beyond this. And it wasn&rsquo;t something that was encouraged. I never had access to any of the tools or environments so any experimentation had to be done in my own time.</p>

<p>An ecommerce side-project I had created the need to build a website. A weekend HTML and CSS course at <a href="http://www.generalassembly.com">General Assembly</a> got me started with the basics. I then hacked and failed over and over again until I eventually spat out a working ecommerce website using an opensource php project called <a href="http://www.opencart.com">Opencart</a>. Cool. My first proper website.</p>

<p>I knew I wanted to learn more. I tried some codeacademy courses, some khan acaedemy, and even bought a javascript book that I read but didn&rsquo;t really understand. I needed some help to get over the hump and I knew that I had to dive in deep and a short weekend course just wouldn&rsquo;t cut it.</p>

<p>I eventually found <a href="http://www.makersacademy.com">Makers Academy</a> and it sounded perfect. 12 weeks of intensive web development training in London. Learning to code full time. Every day. This was going to be the way to get over the hump. After mulling it over for a while.. I clicked sign up.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hello Blog]]></title>
    <link href="http://davwood.github.io/blog/2014/01/10/hello-blog/"/>
    <updated>2014-01-10T14:33:43+11:00</updated>
    <id>http://davwood.github.io/blog/2014/01/10/hello-blog</id>
    <content type="html"><![CDATA[<p>Hello blogging world. I have thought about a blog for a little while. Welcoming in 2014 now seems like a pretty good time.</p>

<p>This will build as a collection of technical knowledge and experiences on the journey to getting better at web development and data visualisations.</p>

<p>This blog is built using <a href="http://octopress.org/">Octopress</a> and the theme <a href="https://github.com/coogie/oscailte/">Oscailtie</a>. Many thanks.</p>
]]></content>
  </entry>
  
</feed>
